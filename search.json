[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Posteos",
    "section": "",
    "text": "Ejemplo de cálculo índice de sequía SPI-12\n\n\n\n\n\n\n\nsequía\n\n\níndices\n\n\nSPI\n\n\n\n\n\n\n\n\n\n\n\n26 ago 2023\n\n\nFrancisco Zambrano\n\n\n\n\n\n\n  \n\n\n\n\nDesaparición de la Laguna Aculeo\n\n\nUna Consecuencia del cambio climático\n\n\n\n\nsequía\n\n\nSPI24\n\n\nAculeo\n\n\n\n\n\n\n\n\n\n\n\n26 ago 2023\n\n\nFrancisco Zambrano\n\n\n\n\n\n\nNo hay resultados"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Acerca",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "posts/post-with-code/index.html",
    "href": "posts/post-with-code/index.html",
    "title": "Post With Code",
    "section": "",
    "text": "This is a post with executable code.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Welcome To My Blog",
    "section": "",
    "text": "This is the first post in a Quarto blog. Welcome!\n\nSince this post doesn’t specify an explicit image, the first image in the post will be used in the listing page of posts."
  },
  {
    "objectID": "posts/ejemplo_spi12/index.html",
    "href": "posts/ejemplo_spi12/index.html",
    "title": "Ejemplo de cálculo índice de sequía SPI-12",
    "section": "",
    "text": "Para el ejemplo se utilizan datos de precipitación acumulada mensual desde enero de 1981 a julio 2023 para la cuenca del río Bueno.\nEl set de datos contiene los valores de precipitacion obtenidos de la aplicación ODES Unidades. Tiene dos columnas, date para las fechas y pre para los valores de precipitación mensual.\n\n\nCódigo\nd |&gt; \n  gt() |&gt; \n  opt_interactive()\n\n\n\n\n\n\n\n\n\n\n\n\nCódigo\n# library(zoo)\n# library(dygraphs)\n# d_zoo &lt;- zoo(d$pre,d$date)\n# dygraph(d_zoo,main = 'Precipitación mensual (mm)')\n\nhighchart2() |&gt;\n  hc_add_series(data =d, type = 'column',name = 'Precipitación mensual (mm)',hcaes(x= date, y = round(pre))) |&gt; \n  hc_xAxis(dateTimeLabelFormats = list(day = '%m  %Y'), type = \"datetime\") \n\n\n\n\n\n\n\nEl Índice Estanadrizado de Precipitación (SPI) considera la precipitación acumulada de \\(n\\) meses, para el ejemplo se considerará la escala de tiempo de \\(n=12\\), para doce meses. Esto quiere decir que para el cálculo del SPI-12 se acumulará la precipitación de los últimos 12 meses, partiendo desde el último mes de la serie, en este caso julio 2023 y yendo mes a mes hacia el primer mes de la serie que corresponde a enero de 1981. Por lo que la precipitación acumulada del mes de julio 2023 será.\n\\[PA12_{julio_{2023}} = \\sum_{agosto_{2022}}^{julio_{2023}} P\\]\ndónde, \\(PA12_{julio_{2023}}\\) corresponde a la precipitación acumulada de los últimos doce meses para julio 2023; y \\(P\\) corresponde a la precipitación acumulada mensual. Esto se repite mes a mes hasta llegar a diciembre de 1981 (\\(PA12_{dic_{1981}}\\)).\n\\[PA12_{dic_{1981}} = \\sum_{enero_{1981}}^{dic_{1981}} P\\] Por lo que el primer mes de la serie será diciembre 2012, ya que los meses anteriores no alzanzan a acumular doce meses de precipitación.\nLa siguiente animación ejemplifica el proceso de acumulación de 12 meses desde julio 2023 hasta diciembre 1981.\nVideo"
  },
  {
    "objectID": "posts/ejemplo_spi12/index.html#acumulación-de-precipitación-para-12-meses",
    "href": "posts/ejemplo_spi12/index.html#acumulación-de-precipitación-para-12-meses",
    "title": "Ejemplo de cálculo índice de sequía SPI-12",
    "section": "",
    "text": "Para el ejemplo se utilizan datos de precipitación acumulada mensual desde enero de 1981 a julio 2023 para la cuenca del río Bueno.\nEl set de datos contiene los valores de precipitacion obtenidos de la aplicación ODES Unidades. Tiene dos columnas, date para las fechas y pre para los valores de precipitación mensual.\n\n\nCódigo\nd |&gt; \n  gt() |&gt; \n  opt_interactive()\n\n\n\n\n\n\n\n\n\n\n\n\nCódigo\n# library(zoo)\n# library(dygraphs)\n# d_zoo &lt;- zoo(d$pre,d$date)\n# dygraph(d_zoo,main = 'Precipitación mensual (mm)')\n\nhighchart2() |&gt;\n  hc_add_series(data =d, type = 'column',name = 'Precipitación mensual (mm)',hcaes(x= date, y = round(pre))) |&gt; \n  hc_xAxis(dateTimeLabelFormats = list(day = '%m  %Y'), type = \"datetime\") \n\n\n\n\n\n\n\nEl Índice Estanadrizado de Precipitación (SPI) considera la precipitación acumulada de \\(n\\) meses, para el ejemplo se considerará la escala de tiempo de \\(n=12\\), para doce meses. Esto quiere decir que para el cálculo del SPI-12 se acumulará la precipitación de los últimos 12 meses, partiendo desde el último mes de la serie, en este caso julio 2023 y yendo mes a mes hacia el primer mes de la serie que corresponde a enero de 1981. Por lo que la precipitación acumulada del mes de julio 2023 será.\n\\[PA12_{julio_{2023}} = \\sum_{agosto_{2022}}^{julio_{2023}} P\\]\ndónde, \\(PA12_{julio_{2023}}\\) corresponde a la precipitación acumulada de los últimos doce meses para julio 2023; y \\(P\\) corresponde a la precipitación acumulada mensual. Esto se repite mes a mes hasta llegar a diciembre de 1981 (\\(PA12_{dic_{1981}}\\)).\n\\[PA12_{dic_{1981}} = \\sum_{enero_{1981}}^{dic_{1981}} P\\] Por lo que el primer mes de la serie será diciembre 2012, ya que los meses anteriores no alzanzan a acumular doce meses de precipitación.\nLa siguiente animación ejemplifica el proceso de acumulación de 12 meses desde julio 2023 hasta diciembre 1981.\nVideo"
  },
  {
    "objectID": "posts/ejemplo_spi12/index.html#spi-12-para-julio-2023",
    "href": "posts/ejemplo_spi12/index.html#spi-12-para-julio-2023",
    "title": "Ejemplo de cálculo índice de sequía SPI-12",
    "section": "SPI-12 para Julio 2023",
    "text": "SPI-12 para Julio 2023\nDel proceso anterior se obtiene la siguiente tabla con los valores acumulados de doce meses entre diciembre 1981 a julio 2023.\n\n\nCódigo\nlibrary(zoo)\nx.t &lt;- zoo(rev(d$pre))\nxt_sum &lt;- rollapply(x.t,12,sum)\n\ndf_12 &lt;- tibble(dates = dates[1:500],pre_12 = as.numeric(xt_sum))\n\ndf_12 |&gt; \n    gt() |&gt; \n  opt_interactive()\n\n\n\n\n\n\n\n\n\n\nLa serie de tiempo de los valores de precipitación acumulada de 12 mese es la siguiente:\n\n\nCódigo\ndf_12 |&gt; \n  ggplot(aes(dates,pre_12)) +\n  geom_col(fill='blue',alpha = .6) + \n  scale_x_date(date_breaks = \"2 years\",date_labels = \"%Y\",expand =c(0,0)) +\n  ylab('Precipitación acumulada 12 meses (mm)') +\n  theme_bw() +\n  theme(axis.title.x = element_blank())"
  },
  {
    "objectID": "posts/ejemplo_spi12/index.html#spi-12-para-julio",
    "href": "posts/ejemplo_spi12/index.html#spi-12-para-julio",
    "title": "Ejemplo de cálculo índice de sequía SPI-12",
    "section": "SPI-12 para Julio",
    "text": "SPI-12 para Julio\nDel proceso anterior se obtiene la siguiente tabla con los valores acumulados de doce meses entre diciembre 1981 a julio 2023.\n\n\nCódigo\nlibrary(zoo)\nx.t &lt;- zoo(rev(d$pre))\nxt_sum &lt;- rollapply(x.t,12,sum)\n\ndf_12 &lt;- tibble(dates = dates[1:500],pre_12 = as.numeric(xt_sum))\n\ndf_12 |&gt; \n    gt() |&gt; \n  opt_interactive()\n\n\n\n\n\n\n\n\n\n\nLa serie de tiempo de los valores de precipitación acumulada de 12 mese es la siguiente:\n\n\nCódigo\ndf_12 |&gt; \n  ggplot(aes(dates,pre_12)) +\n  geom_col(fill='blue',alpha = .6) + \n  scale_x_date(date_breaks = \"2 years\",date_labels = \"%Y\",expand =c(0,0)) +\n  ylab('Precipitación acumulada 12 meses (mm)') +\n  theme_bw() +\n  theme(axis.title.x = element_blank())\n\n\n\n\n\nAhora para el ejemplo continuaré realizando el proceso para los meses de julio, sin embargo, para el resto de los once meses el procedimiento es el mismo.\nEntonces, filtrando los julios tenemos:\n\n\nCódigo\ndf_12_jul &lt;- df_12 |&gt; filter(month(dates) == 7)\n\ndf_12_jul |&gt; \n  gt() |&gt; \n  opt_interactive()\n\n\n\n\n\n\n\n\n\n\n\n\nCódigo\ndf_12_jul |&gt; \n  ggplot(aes(dates,pre_12)) + \n  geom_col(fill = 'blue') +\n  scale_x_date(date_breaks = \"2 years\",date_labels = \"%Y\",expand = c(0,0)) +\n  scale_y_continuous(expand = c(0,0)) +\n  labs(y = 'Precipitación acumulada \\n doce meses (julios) (mm)') +\n  theme_bw() +\n  theme(axis.title.x = element_blank())\n\n\n\n\n\nLos datos de precipitación acumulada mensual de doce meses para todos los julios tiene la siguiente distribución de probabilidades.\n\n\nCódigo\ndf_12_jul |&gt; \n  ggplot(aes(pre)) +\n  geom_density(aes(pre_12),fill = 'blue',alpha=.6) +\n  theme_bw()\n\n\n\n\n\nEsta distribución se normaliza (en caso de ser necesario), es decir se transforma a una distribución normal. Existen diferentes técnicas para normalizar una distribución, hay métodos paramétricos (ej: L-momentos) y no paramétricos. En ODES para el cálculo de todos los indicadores de sequía se utilizan métodos no paramétricos. Por simplicidad, en este caso de ejemplo se realizó el procedimiento de forma paramétrica utilizando {bestNormalize}.\nLa siguiente figura en el panel superior, muestra la distribución de valores de precipitación acumulada de 12 meses para todos los junios, normalizada. En el panel de abajo, se presenta la misma distribución pero con los valores estandarizados, es decir con una media 0 y desviación estandar de 1 (z-score).\nAmbas corresponde a la misma distribución, pero la figura del panel de arriba tiene los valores absolutos y la de abajo valores relativos de acuerdo a una distribución normal estandarizada.\n\n\nCódigo\nlibrary(bestNormalize)\nset.seed(354)\nnorm &lt;- bestNormalize(df_12_jul$pre_12,standardize = FALSE)\ndf_12norm &lt;- tibble(date = df_12_jul$dates,pre_12n = norm$x.t,pre_12ns = as.numeric(scale(norm$x.t)))\n\nvals &lt;- c(mean(df_12norm$pre_12n)-sd(df_12norm$pre_12n),mean(df_12norm$pre_12n),mean(df_12norm$pre_12n)+sd(df_12norm$pre_12n))\nplot_d1 &lt;- ggplot() +\n  geom_density(data =df_12norm,aes(pre_12n),fill = 'blue',alpha=.6) +\n  geom_vline(xintercept = vals[1],col='red',lty = 'dashed',alpha =.4 ) +\n  geom_vline(xintercept = vals[3],col='red',lty = 'dashed',alpha =.4  ) +\n  geom_vline(xintercept = vals[2],col='red',lty = 'dashed',alpha =.4  ) +\n  annotate('text',x = vals[1],y=0.0013,label = paste(\"mu-~sigma==\",round(vals[1],1),\"~mm\"),parse = TRUE ) +\n  annotate('text',x = vals[2],y=0.0013,label = paste(\"mu==\",round(vals[2],1),\"~mm\"),parse = TRUE ) +\n  annotate('text',x = vals[3],y=0.0013,label = paste(\"mu+~sigma==\",round(vals[3],1),\"~mm\"),parse = TRUE ) +\n  xlab('Precipitación acumulada 12 meses (julios) [mm]') +\n  theme_bw()\n\nplot_d2 &lt;- ggplot() +\n  geom_density(data =df_12norm,aes(pre_12ns),fill = 'blue',alpha=.6) +\n  geom_vline(xintercept = -1,col='red',lty = 'dashed',alpha =.4 ) +\n  geom_vline(xintercept = 0,col='red',lty = 'dashed',alpha =.4  ) +\n  geom_vline(xintercept = 1,col='red',lty = 'dashed',alpha =.4  ) +\n  annotate('text',x = -1,y=0.3,label = \"mu-~sigma==-1\",parse = TRUE ) +\n  annotate('text',x = 0,y=0.3,label = \"mu==0\",parse = TRUE ) +\n  annotate('text',x = 1,y=0.3,label = \"mu+~sigma==1\",parse = TRUE ) +\n  xlab('z-score') +\n  theme_bw()\n\nlibrary(gridExtra)\ngrid.arrange(plot_d1,plot_d2,nrow = 2)\n\n\n\n\n\nEntonces, lo que hacen los índices de sequía y en este caso el SPI-12 para los meses de julio. Es llevar los valores de precipitación acumulado a una distribución normal estandarizada. En este caso el promedio de precipitación acumulada de 12 meses corresponden a \\(1600\\) yla desviación estandar a \\(~310mm\\), lo que en la distribución normal estandarizada corresponde a \\(0\\) y \\(1\\), respectivamente.\nLuego, en las figuras de abajo, se muestran las series de tiempo de los valores normalizados absolutos y relativos. Los índices de sequía utilizan los valores relativos, ya que permiten la comparación con diferentes zonas y momentos del año, ya que no depende de la magnitud de la precipitación, sino que de la distribución de probabilidad.\nFinalmente, para calcular el SPI-12 para el resto de los 11 meses, se debe seguir el mismo procedimiento.\n\n\nCódigo\nplot_ts1 &lt;- df_12norm |&gt; \n  mutate(preC = pre_12n - vals[2]) |&gt;  \n  ggplot(aes(date,preC)) +\n  geom_col(aes(fill = pre_12n &gt; vals[2])) +\n  geom_col(aes(fill = pre_12n &lt; vals[2])) +\n  scale_fill_manual(values = c('blue', 'red')) +\n  scale_y_continuous(labels = function(x) round(x + vals[2])) +\n  ylab('Precipitación acumulada de \\n 12 meses normalizada (mm)') +\n  theme_bw() + \n  theme(legend.position = 'none',axis.title.x = element_blank())\n\nplot_ts2 &lt;- ggplot(df_12norm,aes(date,pre_12ns)) +\n  geom_col(aes(fill = pre_12ns &gt; 0)) +\n  geom_col(aes(fill = pre_12ns &lt; 0)) +\n  scale_fill_manual(values = c('blue', 'red')) +\n  ylab('SPI-12')+\n  theme_bw() + \n  theme(legend.position = 'none',axis.title.x = element_blank())\n\ngrid.arrange(plot_ts1,plot_ts2,nrow = 2)"
  },
  {
    "objectID": "posts/laguna_acuelo_spi24/index.html",
    "href": "posts/laguna_acuelo_spi24/index.html",
    "title": "Desaparición de la Laguna Aculeo",
    "section": "",
    "text": "La variación en el almacenamiento de agua en la laguna de Aculeo, está principalmente asociada al impacto que el cambio climático ha tenido en los regimenes de precipitaciones en Chile. Esta situación se puede ver intensificada por la acción del ser humano en la laguna, como aumento en la extracción de agua.\nEl siguiente video muestra una transición de imágenes satelitales tomadas de la laguna desde el año 2013 hasta el 26 de julio 2023.\nComo se puede apreciar en el video, la disminución en el nivel de la laguna ya se veía desde el año 2013. Alcanzando su nivel más bajo -en primer instancia- antes del invierno del año 2016. El 2016 recupera su nivel y desde ahí empieza a disminuir hasta el año 2018 en que se seca completamente.\nVideo\nEn la siguiente figura se presenta el índice estandarizado de precipitaciones de 12 y 24 meses (SPI-12 y SPI-24)1 para el distrito de Aculeo. En los gráficos, los periodos de precipitaciones sobre lo normal se muestran en color azul y bajo lo normal en rojo. La linea gris dicontinua, muestra la tendencia de la sequía.\nEl año 2016, antes del 2023, fue en el que hubo mayor cantidad de agua caida. Después, desde el 2017 los índices de sequía muestran que la precipitación comienza a diminuir. Así, la Laguna de Aculeo se seca el año 2018.\nCódigo\nd |&gt; \n  drop_na() |&gt; \n  pivot_longer(2:3) |&gt; \n  ggplot(aes(date,value)) +\n   geom_ribbon(aes(ymin = pmin(value,0),ymax = 0),fill = 'red',alpha=.7)+\n  geom_ribbon(aes(ymin = 0,ymax = pmax(value,0)),fill = 'blue',alpha=.7)+\n  geom_smooth(method ='lm',se = FALSE,colour ='grey',linetype='dashed') +\n  scale_x_date(date_breaks = \"1 year\",date_labels = \"%Y\",expand = c(0,0)) +\n  labs(x='años',y = 'SPI-24') +\n  facet_grid(name~.) +\n  theme_bw() +\n  theme(axis.text.x = element_text(angle=90))\n\n\n\n\n\nÍndice Estandarizado de precipitaciones (SPI) de 24 meses\nFinalmente, es clara la asociación en la disminución de la precipitación (medida con índices de sequía de largo plazo), con la desaparición de la Laguna de Aculeo. Visto los datos, y las tendencias en la diminución de la precipitación, es el cambio climático el principal causante del secamiento de la laguna, lo que se puede haber intensificado por la acción del ser humano, Pero no al revés."
  },
  {
    "objectID": "posts/laguna_acuelo_spi24/index.html#footnotes",
    "href": "posts/laguna_acuelo_spi24/index.html#footnotes",
    "title": "Desaparición de la Laguna Aculeo",
    "section": "Notas",
    "text": "Notas\n\n\nPara ver un ejemplo de cálculo del SPI haz clic aqui↩︎"
  }
]